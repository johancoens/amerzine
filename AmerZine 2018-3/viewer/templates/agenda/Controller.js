function AgendaController(){function a(){var a=!1;"top"==i.content.nav_type&&(i.content.nav_type="circle",a=!0),m&&(m.init(h.container.find("#tableInside"),NavigationButtonType[i.content.nav_type.toUpperCase()]),m.setTop(a))}function b(a){var b=a.scrollTop(),c=Math.max(0,a[0].scrollHeight-Magazine.pages.height),d=100/(c/b);"undefined"!=typeof m&&null!==m&&m.onScroll(b,b+Magazine.pages.height,a[0].scrollHeight),Math.floor(d/25)!=n&&o&&(n=Math.floor(d/25),Magazine.tracker.trackEvent("Scroll",b>o?"Down":"Up",25*n+"%")),o=b,h.onScrollHandler(b)}function c(){m&&($("#tablecontainer",h.container).height()<=$("#items",h.container).height()?m.show():m.hide())}function d(){if(l=!0,Magazine.device.size>DeviceSize.MOBILE_LANDSCAPE){var a=$(".overlay-agenda",h.container);a.html(f()),k.onResizeHandler(Magazine.device),TweenMax.set(a,{css:{display:"block",opacity:0}}),TweenMax.to(a,.5,{css:{opacity:1,y:20},delay:.5,ease:Quad.easeInOut}),$("#tableInside",h.container).addClass("noshow")}else{var b=new SubPage;b.template=Config.templatePathView+h.template+"/Details_agenda.html",b.data={title:i.content.agenda[j.item].title,description:i.content.agenda[j.item].description,datestr:i.content.agenda[j.item].date,image:i.content.agenda[j.item].image},h.pushPage(b)}}function e(){if(l=!1,Magazine.device.size>DeviceSize.MOBILE_LANDSCAPE){$("#tableInside",h.container).removeClass("noshow");var a=$(".overlay-agenda",h.container)[0];TweenMax.to(a,.5,{css:{opacity:0},ease:Quad.easeInOut,onComplete:function(){TweenMax.set(a,{css:{display:"none",y:-20},ease:Quad.easeInOut})}})}}function f(){var a=i.content.agenda[j.item];return a.urlbase="#!/"+h.alias,a.imageurl=Config.magazine_url,p.render(a)}function g(){"undefined"!=typeof j.item?d():1==l&&e()}var h,i=!1,j=null,k=this,l=!1,m=null,n=0,o=0,p=Hogan.compile('<a href="{{urlbase}}" class="close-button im-ts-button-background button square-small"><span class="im-sp im-sp-times"></span></a><div class="im-ts-title-padding im-ts-title-background"><h2>{{{title}}}</h2><h4>{{{datestr}}}</h4></div><div class="overlayText text-block clearfix">{{#image}}<img src="{{helper(getImageUrl, {image.uri}, null, null, 130, null, 0)}}" class="im-ts-paragraph-padding" />{{/image}}<div class="paragraph">{{{description}}}</div></div>');this.init=function(a){h=a},this.willLoadView=function(a){j=a},this.didLoadView=function(){Magazine.device.size>DeviceSize.MOBILE_LANDSCAPE&&($(".close-button",h.container).click(e),$("h1",h.container).hasTransparentBackground()&&$("h1",h.container).css({"padding-top":"0px","padding-bottom":"0px"}),null!==i.content.nav_type&&"undefined"!=typeof i.content.nav_type&&(m=new NavigationButtons,a(),m.onUp=function(){k.scrollTo(-Magazine.pages.height,!0),Magazine.tracker.trackEvent("Scroll","Click","Up")},m.onDown=function(){k.scrollTo(Magazine.pages.height,!0),Magazine.tracker.trackEvent("Scroll","Click","Down")},m.show()),null!==i.content.background&&(h.getBackground().init([i.content.background]),h.container.prepend(h.getBackground().render()),h.getBackground().show()),$(".tp-agenda .im-ag-overview #tableInside").scroll(function(){h.onScrollHandler($(".tp-agenda .im-ag-overview #tableInside").offset().top-$(".tp-agenda .im-ag-overview #tableInside > table").offset().top)})),h.scanDirectives()},this.scrollTo=function(a){var c,d=$("#tableInside",h.container),e={y:d.scrollTop()};c=isNaN(a)?d.scrollTop()+a.offset().top-Magazine.pages.offset.top:d.scrollTop()+a,c=Math.max(0,Math.min(c,d[0].scrollHeight-d.outerHeight())),TweenLite.to(e,1,{y:c,ease:"easeInOutCubic",onUpdate:function(){d.scrollTop(e.y),b(d)}})},this.willLoad=function(){},this.didLoad=function(a){i=a},this.didAppear=function(){if(Magazine.device.size>DeviceSize.MOBILE_LANDSCAPE&&h.isFirstView()){var a=$("#introtext",h.container)[0];TweenMax.to(a,.5,{css:{opacity:1},ease:Quad.easeInOut,onComplete:g}),$(".im-ag-overview",h.container).startAnimation(IMAnimation.fadeInUp)}else g();c()},this.willAppear=function(a){j=a},this.onHashChange=function(a){j=a,g()},this.onResizeHandler=function(a){$(".alignCenter",h.container).each(function(){var b=$(this),c=b.height();a.screen.height<c?b.css({top:"0px","margin-top":"0px"}):b.css({top:"50%","margin-top":.5*-c})}),c()},this.onEndResizeHandler=function(a){$($("#tableInside",h.container)).on("scroll mousewheel",function(){b($(this))})},this.onOrientationChange=function(){},this.willDisappear=function(){},this.didDisappear=function(){},this.destroy=function(){},this.render=function(a){for(var b in a.agenda)if(a.agenda[b].index=b,a.agenda[b].date&&!isNaN(a.agenda[b].date)){var c=new JSDate(a.agenda[b].date);a.agenda[b].day=c.getDay(),a.agenda[b].month=c.getFullMonthName(),a.agenda[b].year=c.getFullYear(),a.agenda[b].datestr=a.agenda[b].day+" "+a.agenda[b].month+" "+a.agenda[b].year}else a.agenda[b].datestr=a.agenda[b].date}}Loader.loadComplete();