function CenterscrollController(){"use strict";function a(){d&&d.each(function(){"undefined"!=typeof $(this)[0].imMedia&&$(this)[0].imMedia.pause()})}var b,c,d,e=null,f=null,g=[];this.init=function(a){c=a},this.willLoad=function(){},this.willLoadView=function(a){},this.didLoad=function(a){b=a},this.didLoadView=function(){b.content.sidebar&&c.container.addClass("im-g2-sidebar"),this.onSwitchSize(Magazine.device,-1);var a=this;d=c.scanDirectives(),d.each(function(){"undefined"!=typeof this.imMedia&&(this.imMedia.onLoad=function(){a.onResizeHandler(Magazine.device)})}),$("h2",c.container).hasTransparentBackground()&&$("h2",c.container).css({padding:"0px",display:"block"}),$("h4",c.container).hasTransparentBackground()&&$("h4",c.container).css({padding:"0px",display:"block"}),$(".paragraph",c.container).hasTransparentBackground()&&$(".paragraph",c.container).css({padding:"0px"}),b.content.item_space>0&&$(".item",c.container).css({"margin-bottom":b.content.item_space+"px"}),null!=b.content.background&&c.getBackground().init([b.content.background]),c.hasBackground&&(c.container.prepend(c.getBackground().render()),c.getBackground().show()),c.container.find("iframe").each(function(){var a=$(this).attr("src");g.push(a),$(this).attr("src","")})},this.willAppear=function(a){"undefined"!=typeof a.item&&e.scrollTo($("[name=cs-p-"+a.item+"]",c.container),!0)},this.didAppear=function(){var a=$(".im-ts-videocontainer",c.container);a.height(a.width()*(9/16)),c.isFirstView()?(this.onResizeHandler(Magazine.device),d.each(function(){"undefined"!=typeof this.imParallax&&this.imParallax.onScroll()}),$(".im-cs-items",c.container).startAnimation(IMAnimation.fadeInUp),null!==f&&(e.canScroll()?f.show():f.hide()),setTimeout(function(){c.container.find("iframe").each(function(a){$(this).attr("src",g[a])})},100)):d&&d.each(function(){"undefined"!=typeof $(this)[0].imMedia&&"function"==typeof $(this)[0].imMedia.reset&&$(this)[0].imMedia.reset()})},this.willDisappear=function(){a()},this.rowWillAppear=function(){var a=$(this).children(),b=IntroAnimation.contentType,d=IntroAnimation.textType;IntroAnimation.duration,IntroAnimation.textDelay;this.imParallax.isFirstView()&&a.each(function(){$(this).startAnimation(b).css(Magazine.device.getCssProperty("animation-delay"),IntroAnimation.contentDelay+"ms").css(Magazine.device.getCssProperty("AnimationDuration"),IntroAnimation.duration).css("opacity",1),$(this).find(".text",c.container).each(function(a){$(this).startAnimation(d).css(Magazine.device.getCssProperty("animation-delay"),(a+1)*IntroAnimation.textType+"ms")})})},this.rowDidDisappear=function(){a()},this.didDisappear=function(){},this.render=function(a){for(var b in a.scrollitem){a.scrollitem[b].index=b;var c=new StyleModel(a.scrollitem[b].style);a.scrollitem[b].block_style=c.get(["background"]),a.scrollitem[b].block_style_mobile=c.get(["mobile_background"]),a.scrollitem[b].title_style=c.get(["title"]),a.scrollitem[b].subtitle_style=c.get(["subtitle"]),a.scrollitem[b].paragraph_style=c.get("paragraph"),a.scrollitem[b].mobile_title_style=c.get(["mobile_title"]),a.scrollitem[b].mobile_subtitle_style=c.get(["mobile_subtitle"]),a.scrollitem[b].mobile_paragraph_style=c.get("mobile_paragraph"),a.scrollitem[b].title&&(a.scrollitem[b].title=Hogan.compile(a.scrollitem[b].title,{delimiters:"<% %>"}).render({num:b})),a.scrollitem[b].subtitle&&(a.scrollitem[b].subtitle=Hogan.compile(a.scrollitem[b].subtitle,{delimiters:"<% %>"}).render({num:b}))}},this.onSwitchSize=function(a,g){a.size>g&&a.size>DeviceSize.MOBILE_LANDSCAPE&&null===e?(this.mobileHandlers.release(),e=new ScrollHandler,e.addEventListener("onscroll",function(a){c.onScrollHandler(a),d.each(function(){"undefined"!=typeof this.imParallax&&this.imParallax.onScroll()})}),e.init(c.container,$(".im-cs-content",c.container)),e.height=Magazine.pages.height,null===b.content.nav_type&&(b.content.nav_type="bars"),"none"!==b.content.nav_type&&"undefined"!=typeof b.content.nav_type&&(f=new NavigationButtons,f.init(c.container,NavigationButtonType[b.content.nav_type.toUpperCase()]),f.setScrollHandler(e))):a.size<DeviceSize.PORTRAIT&&(null!==e&&(e.release(),e=null),null!==f&&(f.release(),f=null),this.mobileHandlers.init()),$(".im-cs-items",c.container).find(".item").each(function(a){Magazine.device.size<=DeviceSize.MOBILE_LANDSCAPE?b.content.scrollitem[a].block_style_mobile?$($(this)[0]).css("background",b.content.scrollitem[a].block_style_mobile.split(";")[1].split("background: ")[1]):$($(this)[0]).css("background",""):b.content.scrollitem[a].block_style?$($(this)[0]).css("background",b.content.scrollitem[a].block_style.split(";")[1].split("background: ")[1]):$($(this)[0]).css("background","")})},this.onOrientationChange=function(){},this.onHashChange=function(a){"undefined"!=typeof a.item&&e.scrollTo($("[name=cs-p-"+a.item+"]",c.container),!0)},this.onEndResizeHandler=function(a){null!==e&&(e.height=Magazine.pages.height)},this.onResizeHandler=function(a){null!==e&&(e.height=$(".im-cs-wrapper",c.container).height(),e.onResizeHandler(a),null!==f&&(e.canScroll()?f.show():f.hide()));var d=Math.round(Magazine.pages.height*(parseInt(b.content.header_space||0)/100));d+$(".im-cs-items",c.container).outerHeight()<Magazine.pages.height?$(".im-cs-items",c.container).css({position:"absolute",bottom:0}):($(".im-cs-items-spacing",c.container).css({height:d}),$(".im-cs-items",c.container).css({position:"relative",bottom:""}))},this.destroy=function(){e&&(e.release(),e=null)},this.mobileHandlers={scrollPosition:0,scrollStage:0,init:function(){var a=this;$(".im-cs-content",c.container).addClass("scroller").on("scroll mousewheel",function(){a.onScroll($(this))})},onScroll:function(a){var b=a.scrollTop(),e=Math.max(0,a[0].scrollHeight-Magazine.pages.height),f=100/(e/b);Math.floor(f/25)!=this.scrollStage&&(this.scrollStage=Math.floor(f/25),Magazine.tracker.trackEvent("Scroll",b>this.scrollPosition?"Down":"Up",25*this.scrollStage+"%")),this.scrollPosition=b,c.onScrollHandler(b),d.each(function(){"undefined"!=typeof this.imParallax&&this.imParallax.onScroll()})},release:function(){$(".im-cs-content",c.container).removeClass("scroller").css("height",""),$(".im-cs-content",c.container).off("scroll mousewheel")}}}Loader.loadComplete();